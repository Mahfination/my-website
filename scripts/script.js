document.addEventListener('DOMContentLoaded', function() {
    // --- Animation Trigger ---
    // Add 'loaded' class to body after a short delay to trigger animations
    setTimeout(() => {
        document.body.classList.add('loaded');
    }, 200);

    // --- Smooth Scrolling ---
    document.querySelectorAll('nav a').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const targetId = this.getAttribute('href');
            const targetElement = document.querySelector(targetId);
            if (targetElement) {
                window.scrollTo({
                    top: targetElement.offsetTop - 80, // Adjust for sticky header
                    behavior: 'smooth'
                });
            }
        });
    });

    // --- Guide Generation Form ---
    const form = document.getElementById('guide-form');
    const resultsDiv = document.getElementById('results');

    if (form) {
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            const age = parseInt(document.getElementById('age').value);
            const appType = document.getElementById('appType').value;
            const isGovt = document.getElementById('isGovt').value;
            const guideHTML = generateGuide(age, appType, isGovt);
            resultsDiv.innerHTML = guideHTML;
            resultsDiv.classList.remove('hidden');
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
        });
    }

    function generateGuide(age, appType, isGovt) {
        let primaryDoc = '';
        let documents = [];
        if (age < 18) {
            primaryDoc = 'ржЕржирж▓рж╛ржЗржи ржЬржирзНржоржирж┐ржмржирзНржзржи рж╕ржиржж (BRC English Version)';
            documents.push('ржкрж┐рждрж╛ ржУ ржорж╛рждрж╛рж░ ржЬрж╛рждрзАржпрж╝ ржкрж░рж┐ржЪржпрж╝ржкрждрзНрж░рзЗрж░ (NID) ржХржкрж┐');
            if (age < 6) {
                documents.push('<span class="highlight">3R рж╕рж╛ржЗржЬрзЗрж░ ржЧрзНрж░рзЗ ржмрзНржпрж╛ржХржЧрзНрж░рж╛ржЙржирзНржбрзЗрж░ рж▓рзНржпрж╛ржм ржкрзНрж░рж┐ржирзНржЯ ржЫржмрж┐</span>');
            }
        } else if (age >= 18 && age <= 20) {
            primaryDoc = 'ржЬрж╛рждрзАржпрж╝ ржкрж░рж┐ржЪржпрж╝ржкрждрзНрж░ (NID) ржЕржержмрж╛ ржЕржирж▓рж╛ржЗржи ржЬржирзНржоржирж┐ржмржирзНржзржи рж╕ржиржж (BRC English Version) (рждржмрзЗ NID ржжрзЗржУржпрж╝рж╛ ржЙрждрзНрждржо)';
        } else {
            primaryDoc = 'ржЬрж╛рждрзАржпрж╝ ржкрж░рж┐ржЪржпрж╝ржкрждрзНрж░ (NID) - <span class="highlight">ржЖржмрж╢рзНржпржХ</span>';
        }
        if (appType === 'reissue') {
            documents.unshift('ржкрзБрж░рж╛рждржи ржкрж╛рж╕ржкрзЛрж░рзНржЯрзЗрж░ ржорзВрж▓ ржХржкрж┐ ржУ ржбрж╛ржЯрж╛ ржкрзЗржЬрзЗрж░ ржлржЯрзЛржХржкрж┐');
        } else if (appType === 'lost') {
            documents.unshift('<span class="highlight">ржерж╛ржирж╛ржпрж╝ ржХрж░рж╛ рж╕рж╛ржзрж╛рж░ржг ржбрж╛ржпрж╝рзЗрж░рж┐ (GD)-рж░ ржорзВрж▓ ржХржкрж┐</span>');
            documents.push('рж╣рж╛рж░рж┐ржпрж╝рзЗ ржпрж╛ржУржпрж╝рж╛ ржкрж╛рж╕ржкрзЛрж░рзНржЯрзЗрж░ ржлржЯрзЛржХржкрж┐ (ржпржжрж┐ ржерж╛ржХрзЗ)');
        }
        if (isGovt === 'yes') {
            documents.push('ржЕржирж╛ржкрждрзНрждрж┐ржкрждрзНрж░ (NOC)/рж╕рж░ржХрж╛рж░рж┐ ржЖржжрзЗрж╢ (GO)/ржЕржмрж╕рж░рзЛрждрзНрждрж░ ржЫрзБржЯрж┐рж░ ржЖржжрзЗрж╢ (PRL)');
        }
        let policeVerificationStep = (appType === 'new')
            ? '<li><strong>ржкрзБрж▓рж┐рж╢ ржнрзЗрж░рж┐ржлрж┐ржХрзЗрж╢ржи:</strong> ржЖржкржирж╛рж░ ржмрж░рзНрждржорж╛ржи ржУ рж╕рзНржерж╛ржпрж╝рзА ржарж┐ржХрж╛ржирж╛ржпрж╝ ржкрзБрж▓рж┐рж╢ ржнрзЗрж░рж┐ржлрж┐ржХрзЗрж╢ржи рж╣ржмрзЗред ржЕрждрж┐ ржЬрж░рзБрж░рж┐ ржЖржмрзЗржжржирзЗрж░ ржХрзНрж╖рзЗрждрзНрж░рзЗ, <span class="highlight">ржЖржкржирж╛ржХрзЗ ржирж┐ржЬ ржЙржжрзНржпрзЛржЧрзЗ ржкрзБрж▓рж┐рж╢ ржХрзНрж▓рж┐ржпрж╝рж╛рж░рзЗржирзНрж╕ рж╕ржиржж рж╕ржВржЧрзНрж░рж╣ ржХрж░рзЗ ржЖржмрзЗржжржирзЗрж░ рж╕рж╛ржерзЗ ржЬржорж╛ ржжрж┐рждрзЗ рж╣ржмрзЗред</span></li>'
            : '<li><strong>ржкрзБрж▓рж┐рж╢ ржнрзЗрж░рж┐ржлрж┐ржХрзЗрж╢ржи:</strong> ржкрж╛рж╕ржкрзЛрж░рзНржЯ ржиржмрж╛ржпрж╝ржи ржмрж╛ рж░рж┐-ржЗрж╕рзНржпрзБрж░ ржХрзНрж╖рзЗрждрзНрж░рзЗ рж╕рж╛ржзрж╛рж░ржгржд ржкрзБрж▓рж┐рж╢ ржнрзЗрж░рж┐ржлрж┐ржХрзЗрж╢ржи рж╣ржпрж╝ ржирж╛ред</li>';
        let feeAdvice = (isGovt === 'yes') 
            ? '<p class="tip">ЁЯТб <strong>ржмрж┐рж╢рзЗрж╖ рж╕рзБржмрж┐ржзрж╛:</strong> рж╕рж░ржХрж╛рж░рж┐ ржЪрж╛ржХрж░рж┐ржЬрзАржмрзА рж╣ржУржпрж╝рж╛ржпрж╝ ржЖржкржирж┐ рж╕рж╛ржзрж╛рж░ржг ржлрж┐ ржжрж┐ржпрж╝рзЗ ржЬрж░рзБрж░рж┐ рж╕рзЗржмрж╛ ржПржмржВ ржЬрж░рзБрж░рж┐ ржлрж┐ ржжрж┐ржпрж╝рзЗ ржЕрждрж┐ ржЬрж░рзБрж░рж┐ рж╕рзЗржмрж╛ ржкрж╛ржмрзЗржиред</p>' 
            : '';
        let warnings = `<h3>тЭМ ржпрж╛ ржпрж╛ ржХрж░ржмрзЗржи ржирж╛</h3><ul><li>ржЖржмрзЗржжржи ржлрж░ржорзЗ ржЖржкржирж╛рж░ NID ржмрж╛ BRC-ржПрж░ рж╕рж╛ржерзЗ рждржерзНржпрзЗрж░ ржЧрж░ржорж┐рж▓ ржХрж░ржмрзЗржи ржирж╛ред</li><li>ржХрзЛржирзЛ ржжрж╛рж▓рж╛рж▓рзЗрж░ рж╕рж╛рж╣рж╛ржпрзНржп ржирж┐ржмрзЗржи ржирж╛ред</li><li>ржорзВрж▓ ржХрж╛ржЧржЬржкрждрзНрж░ рж▓рзЗржорж┐ржирзЗржЯрж┐ржВ ржХрж░ржмрзЗржи ржирж╛ред</li></ul>`;
        return `<h3>ржЖржкржирж╛рж░ ржЬржирзНржп ржирж┐рж░рзНржзрж╛рж░рж┐ржд ржЧрж╛ржЗржб</h3><h4>ЁЯУД ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржХрж╛ржЧржЬржкрждрзНрж░:</h4><ul><li><strong>ржорзВрж▓ ржбржХрзБржорзЗржирзНржЯ:</strong> ${primaryDoc}</li>${documents.map(doc => `<li>${doc}</li>`).join('')}</ul>${feeAdvice}<h4>тЮбя╕П ржХрж░ржгрзАржпрж╝ (ржзрж╛ржкрзЗ ржзрж╛ржкрзЗ):</h4><ol><li><strong>ржЕржирж▓рж╛ржЗржи ржЖржмрзЗржжржи ржкрзВрж░ржг:</strong> <a href="https://www.epassport.gov.bd/landing" target="_blank">ржЗ-ржкрж╛рж╕ржкрзЛрж░рзНржЯ ржУржпрж╝рзЗржмрж╕рж╛ржЗржЯрзЗ</a> ржпрж╛ржиред ржЖржкржирж╛рж░ ${primaryDoc.includes('NID') ? 'NID' : 'BRC'} ржЕржирзБржпрж╛ржпрж╝рзА рж╕ржХрж▓ рждржерзНржп рж╣рзБржмрж╣рзБ ржкрзВрж░ржг ржХрж░рзБржиред</li><li><strong>ржлрж┐ ржкрж░рж┐рж╢рзЛржз:</strong> рж╕рзБржмрж┐ржзрж╛ржоржд ржлрж┐ ржЕржирж▓рж╛ржЗржи ржмрж╛ ржмрзНржпрж╛ржВржХрзЗ ржП-ржЪрж╛рж▓рж╛ржирзЗрж░ ржорж╛ржзрзНржпржорзЗ ржЬржорж╛ ржжрж┐ржиред</li><li><strong>ржЕржлрж┐рж╕рзЗ ржХрж╛ржЧржЬржкрждрзНрж░ ржЬржорж╛ ржУ ржмрж╛ржпрж╝рзЛржорзЗржЯрзНрж░рж┐ржХрзНрж╕:</strong> ржЖржмрзЗржжржиржкрждрзНрж░рзЗрж░ ржкрзНрж░рж┐ржирзНржЯ ржХржкрж┐, ржлрж┐ ржЬржорж╛рж░ рж░рж╢рж┐ржж ржПржмржВ рж╕ржХрж▓ ржХрж╛ржЧржЬржкрждрзНрж░рзЗрж░ ржорзВрж▓ ржУ ржлржЯрзЛржХржкрж┐ ржирж┐ржпрж╝рзЗ ржкрж╛рж╕ржкрзЛрж░рзНржЯ ржЕржлрж┐рж╕рзЗ ржпрж╛ржиред</li>${policeVerificationStep}<li><strong>ржкрж╛рж╕ржкрзЛрж░рзНржЯ рж╕ржВржЧрзНрж░рж╣:</strong> ржорзЛржмрж╛ржЗрж▓рзЗ SMS ржЖрж╕рж▓рзЗ, ржбрзЗрж▓рж┐ржнрж╛рж░рж┐ рж╕рзНрж▓рж┐ржкржЯрж┐ ржирж┐ржпрж╝рзЗ ржкрж╛рж╕ржкрзЛрж░рзНржЯ рж╕ржВржЧрзНрж░рж╣ ржХрж░рзБржиред</li></ol>${warnings}`;
    }
});