document.addEventListener('DOMContentLoaded', function() {
    // Smooth scrolling for navigation links
    document.querySelectorAll('nav a').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const targetId = this.getAttribute('href');
            const targetElement = document.querySelector(targetId);
            if (targetElement) {
                window.scrollTo({
                    top: targetElement.offsetTop - 80, // Adjust for sticky header
                    behavior: 'smooth'
                });
            }
        });
    });

    // Handle the guide generation form
    const form = document.getElementById('guide-form');
    const resultsDiv = document.getElementById('results');

    form.addEventListener('submit', function(e) {
        e.preventDefault();

        // Get user inputs
        const age = parseInt(document.getElementById('age').value);
        const appType = document.getElementById('appType').value;
        const isGovt = document.getElementById('isGovt').value;

        // Generate the guide HTML
        const guideHTML = generateGuide(age, appType, isGovt);
        
        // Display the results
        resultsDiv.innerHTML = guideHTML;
        resultsDiv.classList.remove('hidden');

        // Scroll to the results
        resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
    });

    // The core logic function
    function generateGuide(age, appType, isGovt) {
        let primaryDoc = '';
        let documents = [];
        let processSteps = '';
        let warnings = '';
        
        // 1. Determine Primary Document based on Age
        if (age < 18) {
            primaryDoc = 'ржЕржирж▓рж╛ржЗржи ржЬржирзНржоржирж┐ржмржирзНржзржи рж╕ржиржж (BRC English Version)';
            documents.push('ржкрж┐рждрж╛ ржУ ржорж╛рждрж╛рж░ ржЬрж╛рждрзАрзЯ ржкрж░рж┐ржЪрзЯржкрждрзНрж░рзЗрж░ (NID) ржХржкрж┐');
            if (age < 6) {
                documents.push('<span class="highlight">3R рж╕рж╛ржЗржЬрзЗрж░ ржЧрзНрж░рзЗ ржмрзНржпрж╛ржХржЧрзНрж░рж╛ржЙржирзНржбрзЗрж░ рж▓рзНржпрж╛ржм ржкрзНрж░рж┐ржирзНржЯ ржЫржмрж┐</span>');
            }
        } else if (age >= 18 && age <= 20) {
            primaryDoc = 'ржЬрж╛рждрзАрзЯ ржкрж░рж┐ржЪрзЯржкрждрзНрж░ (NID) ржЕржержмрж╛ ржЕржирж▓рж╛ржЗржи ржЬржирзНржоржирж┐ржмржирзНржзржи рж╕ржиржж (BRC English Version) (рждржмрзЗ NID ржжрзЗржУрзЯрж╛ ржЙрждрзНрждржо)';
        } else { // age > 20
            primaryDoc = 'ржЬрж╛рждрзАрзЯ ржкрж░рж┐ржЪрзЯржкрждрзНрж░ (NID) - <span class="highlight">ржЖржмрж╢рзНржпржХ</span>';
        }

        // 2. Add documents based on Application Type
        if (appType === 'reissue') {
            documents.unshift('ржкрзБрж░рж╛рждржи ржкрж╛рж╕ржкрзЛрж░рзНржЯрзЗрж░ ржорзВрж▓ ржХржкрж┐ ржУ ржбрж╛ржЯрж╛ ржкрзЗржЬрзЗрж░ ржлржЯрзЛржХржкрж┐');
        } else if (appType === 'lost') {
            documents.unshift('<span class="highlight">ржерж╛ржирж╛рзЯ ржХрж░рж╛ рж╕рж╛ржзрж╛рж░ржг ржбрж╛рзЯрзЗрж░рж┐ (GD)-рж░ ржорзВрж▓ ржХржкрж┐</span>');
            documents.push('рж╣рж╛рж░рж┐рзЯрзЗ ржпрж╛ржУрзЯрж╛ ржкрж╛рж╕ржкрзЛрж░рзНржЯрзЗрж░ ржлржЯрзЛржХржкрж┐ (ржпржжрж┐ ржерж╛ржХрзЗ)');
        }

        // 3. Add documents for special cases
        if (isGovt === 'yes') {
            documents.push('ржЕржирж╛ржкрждрзНрждрж┐ржкрждрзНрж░ (NOC)/рж╕рж░ржХрж╛рж░рж┐ ржЖржжрзЗрж╢ (GO)/ржЕржмрж╕рж░рзЛрждрзНрждрж░ ржЫрзБржЯрж┐рж░ ржЖржжрзЗрж╢ (PRL)');
        }
        
        // 4. Generate Process Steps
        let policeVerificationStep = '';
        if (appType === 'new') {
            policeVerificationStep = '<li><strong>ржкрзБрж▓рж┐рж╢ ржнрзЗрж░рж┐ржлрж┐ржХрзЗрж╢ржи:</strong> ржЖржкржирж╛рж░ ржмрж░рзНрждржорж╛ржи ржУ рж╕рзНржерж╛рзЯрзА ржарж┐ржХрж╛ржирж╛рзЯ ржкрзБрж▓рж┐рж╢ ржнрзЗрж░рж┐ржлрж┐ржХрзЗрж╢ржи рж╣ржмрзЗред ржкрзБрж▓рж┐рж╢ ржХрж░рзНржоржХрж░рзНрждрж╛рж░ рж╕рж╛ржерзЗ ржпрзЛржЧрж╛ржпрзЛржЧ рж░рж╛ржЦрзБржиред ржЕрждрж┐ ржЬрж░рзБрж░рж┐ ржЖржмрзЗржжржирзЗрж░ ржХрзНрж╖рзЗрждрзНрж░рзЗ, <span class="highlight">ржЖржкржирж╛ржХрзЗ ржирж┐ржЬ ржЙржжрзНржпрзЛржЧрзЗ ржкрзБрж▓рж┐рж╢ ржХрзНрж▓рж┐рзЯрж╛рж░рзЗржирзНрж╕ рж╕ржиржж рж╕ржВржЧрзНрж░рж╣ ржХрж░рзЗ ржЖржмрзЗржжржирзЗрж░ рж╕рж╛ржерзЗ ржЬржорж╛ ржжрж┐рждрзЗ рж╣ржмрзЗред</span></li>';
        } else {
             policeVerificationStep = '<li><strong>ржкрзБрж▓рж┐рж╢ ржнрзЗрж░рж┐ржлрж┐ржХрзЗрж╢ржи:</strong> ржкрж╛рж╕ржкрзЛрж░рзНржЯ ржиржмрж╛рзЯржи ржмрж╛ рж░рж┐-ржЗрж╕рзНржпрзБрж░ ржХрзНрж╖рзЗрждрзНрж░рзЗ рж╕рж╛ржзрж╛рж░ржгржд ржкрзБрж▓рж┐рж╢ ржнрзЗрж░рж┐ржлрж┐ржХрзЗрж╢ржи рж╣рзЯ ржирж╛ред</li>';
        }

        let feeAdvice = (isGovt === 'yes') 
            ? '<p class="tip">ЁЯТб <strong>ржмрж┐рж╢рзЗрж╖ рж╕рзБржмрж┐ржзрж╛:</strong> рж╕рж░ржХрж╛рж░рж┐ ржЪрж╛ржХрж░рж┐ржЬрзАржмрзА рж╣ржУрзЯрж╛рзЯ ржЖржкржирж┐ рж╕рж╛ржзрж╛рж░ржг ржлрж┐ ржжрж┐рзЯрзЗ ржЬрж░рзБрж░рж┐ рж╕рзЗржмрж╛ ржПржмржВ ржЬрж░рзБрж░рж┐ ржлрж┐ ржжрж┐рзЯрзЗ ржЕрждрж┐ ржЬрж░рзБрж░рж┐ рж╕рзЗржмрж╛ ржкрж╛ржмрзЗржиред ржлрж┐ ржкрж░рж┐рж╢рзЛржзрзЗрж░ рж╕ржорзЯ ржПржЯрж┐ ржЙрж▓рзНрж▓рзЗржЦ ржХрж░рзБржиред</p>' 
            : '';

        // 5. Generate Warnings/Tips
        warnings = `
            <h3>тЭМ ржпрж╛ ржпрж╛ ржХрж░ржмрзЗржи ржирж╛</h3>
            <ul>
                <li>ржЖржмрзЗржжржи ржлрж░ржорзЗ ржЖржкржирж╛рж░ NID ржмрж╛ BRC-ржПрж░ рж╕рж╛ржерзЗ рждржерзНржпрзЗрж░ ржЧрж░ржорж┐рж▓ ржХрж░ржмрзЗржи ржирж╛ред</li>
                <li>ржХрзЛржирзЛ ржжрж╛рж▓рж╛рж▓рзЗрж░ рж╕рж╛рж╣рж╛ржпрзНржп ржирж┐ржмрзЗржи ржирж╛ред ржкрзБрж░рзЛ ржкрзНрж░ржХрзНрж░рж┐рзЯрж╛ржЯрж┐ ржПржЦржи ржЕржирзЗржХ рж╕рж╣ржЬред</li>
                <li>ржорзВрж▓ ржХрж╛ржЧржЬржкрждрзНрж░ (NID, BRC, ржЖржЧрзЗрж░ ржкрж╛рж╕ржкрзЛрж░рзНржЯ) рж▓рзЗржорж┐ржирзЗржЯрж┐ржВ ржХрж░ржмрзЗржи ржирж╛ред</li>
                <li>ржнрзБрж▓ ржмрж╛ ржорж┐ржерзНржпрж╛ рждржерзНржп ржкрзНрж░ржжрж╛ржи ржХрж░ржмрзЗржи ржирж╛, ржПрждрзЗ ржЖржкржирж╛рж░ ржЖржмрзЗржжржи ржмрж╛рждрж┐рж▓ рж╣рждрзЗ ржкрж╛рж░рзЗред</li>
            </ul>
        `;

        // Assemble the final HTML
        return `
            <h3>ржЖржкржирж╛рж░ ржЬржирзНржп ржирж┐рж░рзНржзрж╛рж░рж┐ржд ржЧрж╛ржЗржб (ржмрзЯрж╕: ${age}, ржзрж░ржи: ${appType === 'new' ? 'ржирждрзБржи' : (appType === 'reissue' ? 'ржиржмрж╛рзЯржи' : 'рж╣рж╛рж░рж╛ржирзЛ')})</h3>
            
            <h3>ЁЯУД ржЖржкржирж╛рж░ ржкрзНрж░рзЯрзЛржЬржирзАрзЯ ржХрж╛ржЧржЬржкрждрзНрж░:</h3>
            <ul>
                <li><strong>ржорзВрж▓ ржбржХрзБржорзЗржирзНржЯ:</strong> ${primaryDoc}</li>
                ${documents.map(doc => `<li>${doc}</li>`).join('')}
                <li>ржЖржкржирж╛рж░ рж╕ржХрж▓ ржХрж╛ржЧржЬржкрждрзНрж░рзЗрж░ ржорзВрж▓ ржХржкрж┐рж░ рж╕рж╛ржерзЗ ржПржХ рж╕рзЗржЯ ржлржЯрзЛржХржкрж┐ржУ ржирж┐рзЯрзЗ ржпрж╛ржмрзЗржиред</li>
            </ul>
            
            ${feeAdvice}

            <h3>тЮбя╕П ржЖржкржирж╛рж░ ржХрж░ржгрзАрзЯ (ржзрж╛ржкрзЗ ржзрж╛ржкрзЗ):</h3>
            <ol>
                <li><strong>ржЕржирж▓рж╛ржЗржи ржЖржмрзЗржжржи ржкрзВрж░ржг:</strong> <a href="https://www.epassport.gov.bd/landing" target="_blank">ржЗ-ржкрж╛рж╕ржкрзЛрж░рзНржЯ ржУрзЯрзЗржмрж╕рж╛ржЗржЯрзЗ</a> ржпрж╛ржиред <span class="highlight">ржЖржкржирж╛рж░ ${primaryDoc.includes('NID') ? 'NID' : 'BRC'} ржЕржирзБржпрж╛рзЯрзА рж╕ржХрж▓ рждржерзНржп рж╣рзБржмрж╣рзБ ржкрзВрж░ржг ржХрж░рзБржиред</span> ржмрж░рзНрждржорж╛ржи ржарж┐ржХрж╛ржирж╛ ржЕржирзБржпрж╛рзЯрзА ржЖржкржирж╛рж░ ржкрж╛рж╕ржкрзЛрж░рзНржЯ ржЕржлрж┐рж╕ ржирж┐рж░рзНржмрж╛ржЪрж┐ржд рж╣ржмрзЗред</li>
                <li><strong>ржлрж┐ ржкрж░рж┐рж╢рзЛржз:</strong> ржЖржкржирж╛рж░ рж╕рзБржмрж┐ржзрж╛ржоржд (рж╕рж╛ржзрж╛рж░ржг/ржЬрж░рзБрж░рж┐/ржЕрждрж┐ ржЬрж░рзБрж░рж┐) ржлрж┐ ржЕржирж▓рж╛ржЗржи (bKash, Nagad, Card) ржЕржержмрж╛ ржмрзНржпрж╛ржВржХрзЗ ржП-ржЪрж╛рж▓рж╛ржирзЗрж░ ржорж╛ржзрзНржпржорзЗ ржЬржорж╛ ржжрж┐рзЯрзЗ рж░рж╢рж┐ржж рж╕ржВржЧрзНрж░рж╣ ржХрж░рзБржиред</li>
                <li><strong>ржЕржлрж┐рж╕рзЗ ржХрж╛ржЧржЬржкрждрзНрж░ ржЬржорж╛ ржУ ржмрж╛рзЯрзЛржорзЗржЯрзНрж░рж┐ржХрзНрж╕:</strong> ржЖржмрзЗржжржиржкрждрзНрж░рзЗрж░ ржкрзНрж░рж┐ржирзНржЯ ржХржкрж┐, ржлрж┐ ржЬржорж╛рж░ рж░рж╢рж┐ржж ржПржмржВ ржЙржкрж░рзЗ ржЙрж▓рзНрж▓рзЗржЦрж┐ржд рж╕ржХрж▓ ржХрж╛ржЧржЬржкрждрзНрж░рзЗрж░ ржорзВрж▓ ржУ ржлржЯрзЛржХржкрж┐ ржирж┐рзЯрзЗ ржирж┐рж░рзНржзрж╛рж░рж┐ржд рждрж╛рж░рж┐ржЦрзЗ ржкрж╛рж╕ржкрзЛрж░рзНржЯ ржЕржлрж┐рж╕рзЗ ржпрж╛ржиред ржЫржмрж┐ рждрзЛрж▓рж╛, ржЖржЩрзБрж▓рзЗрж░ ржЫрж╛ржк ржУ ржбрж┐ржЬрж┐ржЯрж╛рж▓ рж╕рзНржмрж╛ржХрзНрж╖рж░ ржирзЗржУрзЯрж╛ рж╣ржмрзЗред</li>
                ${policeVerificationStep}
                <li><strong>ржкрж╛рж╕ржкрзЛрж░рзНржЯ рж╕ржВржЧрзНрж░рж╣:</strong> ржЖржкржирж╛рж░ ржорзЛржмрж╛ржЗрж▓рзЗ ржкрж╛рж╕ржкрзЛрж░рзНржЯ ржкрзНрж░рж╕рзНрждрзБржд рж╣ржУрзЯрж╛рж░ SMS ржЖрж╕рж▓рзЗ, ржбрзЗрж▓рж┐ржнрж╛рж░рж┐ рж╕рзНрж▓рж┐ржкржЯрж┐ ржирж┐рзЯрзЗ ржкрж╛рж╕ржкрзЛрж░рзНржЯ ржЕржлрж┐рж╕ ржерзЗржХрзЗ ржЖржкржирж╛рж░ ржирждрзБржи ржЗ-ржкрж╛рж╕ржкрзЛрж░рзНржЯ рж╕ржВржЧрзНрж░рж╣ ржХрж░рзБржиред</li>
            </ol>
            
            ${warnings}
        `;
    }
});